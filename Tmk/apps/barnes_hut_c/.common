 #
 # $Id: .common,v 1.3 1998/11/03 04:21:55 alc Exp $
 #
TmkDIR  = ../../..
TmkLIB  = $(TmkDIR)/lib.$(ARCH)

CPPFLAGS= -I$(TmkDIR)/include -DTWO_CLUSTER -DTHREEDIM

OBJS	= $(MACHDEP_OBJS) code.o code_io.o getparam.o grav.o load.o util.o

barnes.atm: $(OBJS) $(TmkLIB)/libTmk_udp.a
	$(CC) $(CFLAGS) -o $@ $(OBJS) -L$(TmkLIB) -lTmk_atm -L/usr/fore/lib -latm $(MACHDEP_LIBS)

barnes.mpl: $(OBJS) $(TmkLIB)/libTmk_mpl.a
	$(CC) $(CFLAGS) -o $@ $(OBJS) -L$(TmkLIB) -lTmk_mpl $(MACHDEP_LIBS)

barnes.udp: $(OBJS) $(TmkLIB)/libTmk_udp.a
	$(CC) $(CFLAGS) -o $@ $(OBJS) -L$(TmkLIB) -lTmk_udp $(MACHDEP_LIBS)

barnes.udp_ll: $(OBJS) $(TmkLIB)/libTmk_udp_ll.a
	$(CC) $(CFLAGS) -o $@ $(OBJS) -L$(TmkLIB) -lTmk_udp_ll -L$(LL)/lib -lllapi $(MACHDEP_LIBS)

code.o: ../src/code.c ../src/code.h ../src/util.c ../src/defs.h ../src/vectmath.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/code.c

code_io.o: ../src/code_io.c ../src/code.h ../src/vectmath.h ../src/defs.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/code_io.c

getparam.o: ../src/getparam.c ../src/stdinc.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/getparam.c

grav.o: ../src/grav.c ../src/code.h ../src/vectmath.h ../src/defs.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/grav.c

load.o: ../src/load.c ../src/code.h ../src/vectmath.h ../src/defs.h
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/load.c

util.o: ../src/util.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -c ../src/util.c

clean:
	rm -f *.o *.atm *.udp *.udp_ll sample.out
